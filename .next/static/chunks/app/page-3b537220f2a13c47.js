(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{9416:function(e,s,a){Promise.resolve().then(a.bind(a,1e3))},1e3:function(e,s,a){"use strict";a.r(s),a.d(s,{default:function(){return e_}});var t=a(7437),r=a(2265),l=a(7053),i=a(535),n=a(1994),d=a(3335);function c(){for(var e=arguments.length,s=Array(e),a=0;a<e;a++)s[a]=arguments[a];return(0,d.m6)((0,n.W)(s))}let o=(0,i.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),m=r.forwardRef((e,s)=>{let{className:a,variant:r,size:i,asChild:n=!1,...d}=e,m=n?l.g7:"button";return(0,t.jsx)(m,{className:c(o({variant:r,size:i,className:a})),ref:s,...d})});m.displayName="Button";let x=r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)("div",{ref:s,className:c("rounded-lg border bg-card text-card-foreground shadow-sm",a),...r})});x.displayName="Card";let h=r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)("div",{ref:s,className:c("flex flex-col space-y-1.5 p-6",a),...r})});h.displayName="CardHeader";let u=r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)("div",{ref:s,className:c("text-2xl font-semibold leading-none tracking-tight",a),...r})});u.displayName="CardTitle";let p=r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)("div",{ref:s,className:c("text-sm text-muted-foreground",a),...r})});p.displayName="CardDescription";let f=r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)("div",{ref:s,className:c("p-6 pt-0",a),...r})});f.displayName="CardContent",r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)("div",{ref:s,className:c("flex items-center p-6 pt-0",a),...r})}).displayName="CardFooter";var j=a(6394);let g=(0,i.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),N=r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)(j.f,{ref:s,className:c(g(),a),...r})});N.displayName=j.f.displayName;var v=a(3247),y=a(1047),b=a(5805),w=a(401),k=a(6381),S=a(7692),C=a(5517);let D=C.fC,P=C.xz,Z=r.forwardRef((e,s)=>{let{className:a,align:r="center",sideOffset:l=4,...i}=e;return(0,t.jsx)(C.h_,{children:(0,t.jsx)(C.VY,{ref:s,align:r,sideOffset:l,className:c("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a),...i})})});Z.displayName=C.VY.displayName;var R=a(8947),_=a(5885),F=a(2489);let B=_.fC;_.xz;let T=_.h_;_.x8;let Y=r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)(_.aV,{ref:s,className:c("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...r})});Y.displayName=_.aV.displayName;let O=r.forwardRef((e,s)=>{let{className:a,children:r,...l}=e;return(0,t.jsxs)(T,{children:[(0,t.jsx)(Y,{}),(0,t.jsxs)(_.VY,{ref:s,className:c("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a),...l,children:[r,(0,t.jsxs)(_.x8,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,t.jsx)(F.Z,{className:"h-4 w-4"}),(0,t.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});O.displayName=_.VY.displayName,r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)(_.Dx,{ref:s,className:c("text-lg font-semibold leading-none tracking-tight",a),...r})}).displayName=_.Dx.displayName,r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)(_.dk,{ref:s,className:c("text-sm text-muted-foreground",a),...r})}).displayName=_.dk.displayName;let z=r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)(R.mY,{ref:s,className:c("flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground",a),...r})});z.displayName=R.mY.displayName;let q=r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsxs)("div",{className:"flex items-center border-b px-3","cmdk-input-wrapper":"",children:[(0,t.jsx)(v.Z,{className:"mr-2 h-4 w-4 shrink-0 opacity-50"}),(0,t.jsx)(R.mY.Input,{ref:s,className:c("flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50",a),...r})]})});q.displayName=R.mY.Input.displayName;let E=r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)(R.mY.List,{ref:s,className:c("max-h-[300px] overflow-y-auto overflow-x-hidden",a),...r})});E.displayName=R.mY.List.displayName;let I=r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)(R.mY.Empty,{ref:s,className:c("py-6 text-center text-sm",a),...r})});I.displayName=R.mY.Empty.displayName;let V=r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)(R.mY.Group,{ref:s,className:c("overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground",a),...r})});V.displayName=R.mY.Group.displayName,r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)(R.mY.Separator,{ref:s,className:c("-mx-1 h-px bg-border",a),...r})}).displayName=R.mY.Separator.displayName;let A=r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)(R.mY.Item,{ref:s,className:c("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none aria-selected:bg-accent aria-selected:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),...r})});A.displayName=R.mY.Item.displayName;var M=a(3774),$=a(4156);function L(e){let{placeholder:s="Search airports...",onSelect:a,selectedAirport:l}=e,[i,n]=(0,r.useState)(!1),[d,o]=(0,r.useState)([]),[x,h]=(0,r.useState)(!1);return(0,r.useEffect)(()=>{(async()=>{h(!0);try{let e=await fetch("/api/airports");if(e.ok){let s=await e.json();o(s)}}catch(e){console.error("Failed to fetch airports:",e)}finally{h(!1)}})()},[]),(0,t.jsxs)(D,{open:i,onOpenChange:n,children:[(0,t.jsx)(P,{asChild:!0,children:(0,t.jsxs)(m,{variant:"outline",role:"combobox","aria-expanded":i,className:"w-full justify-between",children:[l?(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(M.Z,{className:"h-4 w-4"}),(0,t.jsxs)("span",{className:"truncate",children:[l.code," - ",l.city,", ",l.country]})]}):(0,t.jsx)("span",{className:"text-muted-foreground",children:s}),(0,t.jsx)($.Z,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),(0,t.jsx)(Z,{className:"w-[400px] p-0",children:(0,t.jsxs)(z,{children:[(0,t.jsx)(q,{placeholder:"Search airports..."}),(0,t.jsxs)(E,{children:[(0,t.jsx)(I,{children:x?"Loading airports...":"No airports found."}),(0,t.jsx)(V,{children:d.map(e=>(0,t.jsxs)(A,{value:"".concat(e.code," ").concat(e.name," ").concat(e.city," ").concat(e.country),onSelect:()=>{a(e),n(!1)},children:[(0,t.jsx)(w.Z,{className:c("mr-2 h-4 w-4",(null==l?void 0:l.code)===e.code?"opacity-100":"opacity-0")}),(0,t.jsxs)("div",{className:"flex flex-col",children:[(0,t.jsxs)("div",{className:"font-medium",children:[e.code," - ",e.name]}),(0,t.jsxs)("div",{className:"text-sm text-muted-foreground",children:[e.city,", ",e.country]})]})]},e.code))})]})]})})]})}let J=r.forwardRef((e,s)=>{let{className:a,type:r,...l}=e;return(0,t.jsx)("input",{type:r,className:c("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),ref:s,...l})});J.displayName="Input";var U=a(1312);let G=U.fC,W=r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)(U.aV,{ref:s,className:c("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",a),...r})});W.displayName=U.aV.displayName;let H=r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)(U.xz,{ref:s,className:c("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",a),...r})});H.displayName=U.xz.displayName;let K=r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)(U.VY,{ref:s,className:c("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",a),...r})});K.displayName=U.VY.displayName;var Q=a(7769),X=a(2208);function ee(e){let{onLoginSuccess:s,onClose:a}=e,[l,i]=(0,r.useState)(!1),[n,d]=(0,r.useState)(!1),[c,o]=(0,r.useState)({email:"",password:""}),[j,g]=(0,r.useState)({name:"",email:"",password:"",confirmPassword:""}),[v,y]=(0,r.useState)(null),[b,w]=(0,r.useState)(null),S=async e=>{e.preventDefault(),d(!0),y(null);try{let e=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(c)}),t=await e.json();e.ok?(localStorage.setItem("user",JSON.stringify(t.user)),localStorage.setItem("token",t.token),s(),a()):y(t.error||"Login failed")}catch(e){console.error("Login error:",e),y("Login failed. Please check your connection and try again.")}finally{d(!1)}},C=async e=>{if(e.preventDefault(),w(null),j.password!==j.confirmPassword){w("Passwords do not match");return}d(!0);try{let e=await fetch("/api/auth/signup",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:j.name,email:j.email,password:j.password})}),t=await e.json();e.ok?(localStorage.setItem("user",JSON.stringify(t.user)),localStorage.setItem("token",t.token),s(),a()):w(t.error||"Signup failed")}catch(e){console.error("Signup error:",e),w("Signup failed. Please check your connection and try again.")}finally{d(!1)}};return(0,t.jsxs)(x,{className:"w-full max-w-md relative",children:[" ",(0,t.jsxs)(m,{variant:"ghost",size:"sm",className:"absolute top-2 right-2 h-8 w-8 p-0",onClick:a,children:[(0,t.jsx)(F.Z,{className:"h-4 w-4"}),(0,t.jsx)("span",{className:"sr-only",children:"Close"})]}),(0,t.jsxs)(h,{className:"text-center",children:[(0,t.jsxs)("div",{className:"flex items-center justify-center space-x-2 mb-4",children:[(0,t.jsx)(k.Z,{className:"h-8 w-8 text-blue-600"}),(0,t.jsx)("h1",{className:"text-2xl font-bold",children:"SkyBooker"})]}),(0,t.jsx)(u,{children:"Welcome"}),(0,t.jsx)(p,{children:"Sign in to your account or create a new one"})]}),(0,t.jsx)(f,{children:(0,t.jsxs)(G,{defaultValue:"login",className:"w-full",children:[(0,t.jsxs)(W,{className:"grid w-full grid-cols-2",children:[(0,t.jsx)(H,{value:"login",children:"Login"}),(0,t.jsx)(H,{value:"signup",children:"Sign Up"})]}),(0,t.jsx)(K,{value:"login",children:(0,t.jsxs)("form",{onSubmit:S,className:"space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(N,{htmlFor:"email",children:"Email"}),(0,t.jsx)(J,{id:"email",type:"email",placeholder:"Enter your email",value:c.email,onChange:e=>o(s=>({...s,email:e.target.value})),required:!0})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(N,{htmlFor:"password",children:"Password"}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(J,{id:"password",type:l?"text":"password",placeholder:"Enter your password",value:c.password,onChange:e=>o(s=>({...s,password:e.target.value})),required:!0}),(0,t.jsx)(m,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-full px-3 py-2 hover:bg-transparent",onClick:()=>i(!l),children:l?(0,t.jsx)(Q.Z,{className:"h-4 w-4"}):(0,t.jsx)(X.Z,{className:"h-4 w-4"})})]})]}),v&&(0,t.jsx)("p",{className:"text-red-500 text-sm",children:v}),(0,t.jsx)(m,{type:"submit",className:"w-full",disabled:n,children:n?"Signing in...":"Sign In"})]})}),(0,t.jsx)(K,{value:"signup",children:(0,t.jsxs)("form",{onSubmit:C,className:"space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(N,{htmlFor:"name",children:"Full Name"}),(0,t.jsx)(J,{id:"name",type:"text",placeholder:"Enter your full name",value:j.name,onChange:e=>g(s=>({...s,name:e.target.value})),required:!0})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(N,{htmlFor:"signup-email",children:"Email"}),(0,t.jsx)(J,{id:"signup-email",type:"email",placeholder:"Enter your email",value:j.email,onChange:e=>g(s=>({...s,email:e.target.value})),required:!0})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(N,{htmlFor:"signup-password",children:"Password"}),(0,t.jsx)(J,{id:"signup-password",type:"password",placeholder:"Create a password",value:j.password,onChange:e=>g(s=>({...s,password:e.target.value})),required:!0})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(N,{htmlFor:"confirm-password",children:"Confirm Password"}),(0,t.jsx)(J,{id:"confirm-password",type:"password",placeholder:"Confirm your password",value:j.confirmPassword,onChange:e=>g(s=>({...s,confirmPassword:e.target.value})),required:!0})]}),b&&(0,t.jsx)("p",{className:"text-red-500 text-sm",children:b}),(0,t.jsx)(m,{type:"submit",className:"w-full",disabled:n,children:n?"Creating account...":"Create Account"})]})})]})})]})}let es=(0,i.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function ea(e){let{className:s,variant:a,...r}=e;return(0,t.jsx)("div",{className:c(es({variant:a}),s),...r})}var et=a(1723);let er=e=>{let{flight:s,onSelect:a}=e;return(0,t.jsx)(x,{className:"mb-4",children:(0,t.jsx)(f,{className:"p-6",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-4 mb-4",children:[(0,t.jsx)("div",{className:"text-lg font-semibold",children:s.airline}),(0,t.jsx)(ea,{variant:"secondary",children:s.flightNumber}),(0,t.jsx)(ea,{variant:0===s.stops?"default":"secondary",children:0===s.stops?"Direct":"".concat(s.stops," stop").concat(s.stops>1?"s":"")})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 items-center",children:[(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"text-2xl font-bold",children:s.departure.time}),(0,t.jsx)("div",{className:"text-sm text-muted-foreground",children:s.departure.airport}),(0,t.jsx)("div",{className:"text-xs text-muted-foreground",children:s.departure.date})]}),(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsxs)("div",{className:"flex items-center justify-center space-x-2 mb-2",children:[(0,t.jsx)("div",{className:"h-px bg-gray-300 flex-1"}),(0,t.jsx)(k.Z,{className:"h-4 w-4 text-gray-400"}),(0,t.jsx)("div",{className:"h-px bg-gray-300 flex-1"})]}),(0,t.jsxs)("div",{className:"text-sm text-muted-foreground flex items-center justify-center space-x-1",children:[(0,t.jsx)(et.Z,{className:"h-3 w-3"}),(0,t.jsx)("span",{children:s.duration})]}),(0,t.jsx)("div",{className:"text-xs text-muted-foreground",children:s.aircraft})]}),(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"text-2xl font-bold",children:s.arrival.time}),(0,t.jsx)("div",{className:"text-sm text-muted-foreground",children:s.arrival.airport}),(0,t.jsx)("div",{className:"text-xs text-muted-foreground",children:s.arrival.date})]})]})]}),(0,t.jsxs)("div",{className:"ml-6 text-right",children:[(0,t.jsxs)("div",{className:"text-2xl font-bold text-blue-600",children:["$",s.price]}),(0,t.jsx)(m,{className:"mt-2",onClick:a,children:"Select Flight"})]})]})})})};function el(e){let{results:s,onFlightSelect:a}=e;return(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)(x,{children:[(0,t.jsx)(h,{children:(0,t.jsxs)(u,{className:"flex items-center space-x-2",children:[(0,t.jsx)(k.Z,{className:"h-5 w-5"}),(0,t.jsx)("span",{children:"Outbound Flights"})]})}),(0,t.jsx)(f,{children:s.outbound.map(e=>(0,t.jsx)(er,{flight:e,onSelect:()=>{console.log("Outbound flight selected:",e),a(e,"outbound")}},e.id))})]}),s.return&&s.return.length>0&&(0,t.jsxs)(x,{children:[(0,t.jsx)(h,{children:(0,t.jsxs)(u,{className:"flex items-center space-x-2",children:[(0,t.jsx)(k.Z,{className:"h-5 w-5 rotate-180"}),(0,t.jsx)("span",{children:"Return Flights"})]})}),(0,t.jsx)(f,{children:s.return.map(e=>(0,t.jsx)(er,{flight:e,onSelect:()=>{console.log("Return flight selected:",e),a(e,"return")}},e.id))})]})]})}var ei=a(2255),en=a(4370);function ed(e){let{className:s,classNames:a,showOutsideDays:r=!0,...l}=e;return(0,t.jsx)(en._,{showOutsideDays:r,className:c("p-3",s),classNames:{months:"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",month:"space-y-4",caption:"flex justify-center pt-1 relative items-center",caption_label:"text-sm font-medium",nav:"space-x-1 flex items-center",nav_button:c(o({variant:"outline"}),"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-y-1",head_row:"flex",head_cell:"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]",row:"flex w-full mt-2",cell:"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20",day:c(o({variant:"ghost"}),"h-9 w-9 p-0 font-normal aria-selected:opacity-100"),day_range_end:"day-range-end",day_selected:"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",day_today:"bg-accent text-accent-foreground",day_outside:"day-outside text-muted-foreground opacity-50 aria-selected:bg-accent/50 aria-selected:text-muted-foreground aria-selected:opacity-30",day_disabled:"text-muted-foreground opacity-50",day_range_middle:"aria-selected:bg-accent aria-selected:text-accent-foreground",day_hidden:"invisible",...a},...l})}ed.displayName="Calendar";var ec=a(6135),eo=a(875),em=a(2135);let ex=ec.fC;ec.ZA;let eh=ec.B4,eu=r.forwardRef((e,s)=>{let{className:a,children:r,...l}=e;return(0,t.jsxs)(ec.xz,{ref:s,className:c("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",a),...l,children:[r,(0,t.jsx)(ec.JO,{asChild:!0,children:(0,t.jsx)(eo.Z,{className:"h-4 w-4 opacity-50"})})]})});eu.displayName=ec.xz.displayName;let ep=r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)(ec.u_,{ref:s,className:c("flex cursor-default items-center justify-center py-1",a),...r,children:(0,t.jsx)(em.Z,{className:"h-4 w-4"})})});ep.displayName=ec.u_.displayName;let ef=r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)(ec.$G,{ref:s,className:c("flex cursor-default items-center justify-center py-1",a),...r,children:(0,t.jsx)(eo.Z,{className:"h-4 w-4"})})});ef.displayName=ec.$G.displayName;let ej=r.forwardRef((e,s)=>{let{className:a,children:r,position:l="popper",...i}=e;return(0,t.jsx)(ec.h_,{children:(0,t.jsxs)(ec.VY,{ref:s,className:c("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===l&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",a),position:l,...i,children:[(0,t.jsx)(ep,{}),(0,t.jsx)(ec.l_,{className:c("p-1","popper"===l&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:r}),(0,t.jsx)(ef,{})]})})});ej.displayName=ec.VY.displayName,r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)(ec.__,{ref:s,className:c("py-1.5 pl-8 pr-2 text-sm font-semibold",a),...r})}).displayName=ec.__.displayName;let eg=r.forwardRef((e,s)=>{let{className:a,children:r,...l}=e;return(0,t.jsxs)(ec.ck,{ref:s,className:c("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),...l,children:[(0,t.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,t.jsx)(ec.wU,{children:(0,t.jsx)(w.Z,{className:"h-4 w-4"})})}),(0,t.jsx)(ec.eT,{children:r})]})});eg.displayName=ec.ck.displayName,r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)(ec.Z0,{ref:s,className:c("-mx-1 my-1 h-px bg-muted",a),...r})}).displayName=ec.Z0.displayName;var eN=a(5156);let ev=r.forwardRef((e,s)=>{let{className:a,orientation:r="horizontal",decorative:l=!0,...i}=e;return(0,t.jsx)(eN.f,{ref:s,decorative:l,orientation:r,className:c("shrink-0 bg-border","horizontal"===r?"h-[1px] w-full":"h-full w-[1px]",a),...i})});ev.displayName=eN.f.displayName;var ey=a(2369),eb=a(8226);function ew(e){var s,a;let{selectedFlights:l,passengers:i,onBookingComplete:n,onBack:d}=e,[c,o]=(0,r.useState)(Array.from({length:i},(e,s)=>({id:s+1,firstName:"",lastName:"",email:"",phone:"",dateOfBirth:"",gender:""}))),[p,j]=(0,r.useState)({cardNumber:"",expiryDate:"",cvv:"",cardholderName:""}),[g,v]=(0,r.useState)(!1),y=((null===(s=l.outbound)||void 0===s?void 0:s.price)||0)+((null===(a=l.return)||void 0===a?void 0:a.price)||0),b=y*i*1.15,w=(e,s,a)=>{o(t=>t.map((t,r)=>r===e?{...t,[s]:a}:t))},S=async()=>{v(!0);try{let e=await fetch("/api/bookings/create",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("token"))},body:JSON.stringify({flights:l,passengers:c,payment:p,totalPrice:b})});if(e.ok){let s=await e.json();alert("Booking confirmed! Your booking reference is: ".concat(s.bookingReference)),n()}else throw Error("Booking failed")}catch(e){console.error("Booking error:",e),alert("Booking failed. Please try again.")}finally{v(!1)}},C=e=>{let{flight:s,label:a}=e;return(0,t.jsxs)("div",{className:"border rounded-lg p-4 mb-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,t.jsx)("h4",{className:"font-semibold",children:a}),(0,t.jsx)(ea,{variant:"secondary",children:s.flightNumber})]}),(0,t.jsxs)("div",{className:"grid grid-cols-3 gap-4 text-sm",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"font-medium",children:s.departure.time}),(0,t.jsx)("div",{className:"text-muted-foreground",children:s.departure.airport}),(0,t.jsx)("div",{className:"text-xs text-muted-foreground",children:s.departure.date})]}),(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"text-muted-foreground",children:s.duration}),(0,t.jsx)("div",{className:"text-xs",children:s.airline})]}),(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsx)("div",{className:"font-medium",children:s.arrival.time}),(0,t.jsx)("div",{className:"text-muted-foreground",children:s.arrival.airport}),(0,t.jsx)("div",{className:"text-xs text-muted-foreground",children:s.arrival.date})]})]}),(0,t.jsx)("div",{className:"mt-2 text-right",children:(0,t.jsxs)("span",{className:"font-semibold text-blue-600",children:["$",s.price," per person"]})})]})};return(0,t.jsxs)("div",{className:"max-w-4xl mx-auto space-y-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("h2",{className:"text-2xl font-bold",children:"Complete Your Booking"}),(0,t.jsx)(m,{variant:"outline",onClick:d,children:"Back to Search"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,t.jsxs)("div",{className:"lg:col-span-2 space-y-6",children:[(0,t.jsxs)(x,{children:[(0,t.jsx)(h,{children:(0,t.jsxs)(u,{className:"flex items-center space-x-2",children:[(0,t.jsx)(k.Z,{className:"h-5 w-5"}),(0,t.jsx)("span",{children:"Flight Summary"})]})}),(0,t.jsxs)(f,{children:[l.outbound&&(0,t.jsx)(C,{flight:l.outbound,label:"Outbound Flight"}),l.return&&(0,t.jsx)(C,{flight:l.return,label:"Return Flight"})]})]}),(0,t.jsxs)(x,{children:[(0,t.jsx)(h,{children:(0,t.jsxs)(u,{className:"flex items-center space-x-2",children:[(0,t.jsx)(ey.Z,{className:"h-5 w-5"}),(0,t.jsx)("span",{children:"Passenger Details"})]})}),(0,t.jsx)(f,{className:"space-y-6",children:c.map((e,s)=>(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("h4",{className:"font-semibold",children:["Passenger ",s+1]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(N,{children:"First Name"}),(0,t.jsx)(J,{value:e.firstName,onChange:e=>w(s,"firstName",e.target.value),required:!0})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(N,{children:"Last Name"}),(0,t.jsx)(J,{value:e.lastName,onChange:e=>w(s,"lastName",e.target.value),required:!0})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(N,{children:"Email"}),(0,t.jsx)(J,{type:"email",value:e.email,onChange:e=>w(s,"email",e.target.value),required:!0})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(N,{children:"Phone"}),(0,t.jsx)(J,{value:e.phone,onChange:e=>w(s,"phone",e.target.value),required:!0})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(N,{children:"Date of Birth"}),(0,t.jsx)(J,{type:"date",value:e.dateOfBirth,onChange:e=>w(s,"dateOfBirth",e.target.value),required:!0})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(N,{children:"Gender"}),(0,t.jsxs)(ex,{value:e.gender,onValueChange:e=>w(s,"gender",e),children:[(0,t.jsx)(eu,{children:(0,t.jsx)(eh,{placeholder:"Select gender"})}),(0,t.jsxs)(ej,{children:[(0,t.jsx)(eg,{value:"male",children:"Male"}),(0,t.jsx)(eg,{value:"female",children:"Female"}),(0,t.jsx)(eg,{value:"other",children:"Other"})]})]})]})]}),s<c.length-1&&(0,t.jsx)(ev,{})]},e.id))})]}),(0,t.jsxs)(x,{children:[(0,t.jsx)(h,{children:(0,t.jsxs)(u,{className:"flex items-center space-x-2",children:[(0,t.jsx)(eb.Z,{className:"h-5 w-5"}),(0,t.jsx)("span",{children:"Payment Details"})]})}),(0,t.jsxs)(f,{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(N,{children:"Cardholder Name"}),(0,t.jsx)(J,{value:p.cardholderName,onChange:e=>j(s=>({...s,cardholderName:e.target.value})),required:!0})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(N,{children:"Card Number"}),(0,t.jsx)(J,{value:p.cardNumber,onChange:e=>j(s=>({...s,cardNumber:e.target.value})),placeholder:"1234 5678 9012 3456",required:!0})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(N,{children:"Expiry Date"}),(0,t.jsx)(J,{value:p.expiryDate,onChange:e=>j(s=>({...s,expiryDate:e.target.value})),placeholder:"MM/YY",required:!0})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(N,{children:"CVV"}),(0,t.jsx)(J,{value:p.cvv,onChange:e=>j(s=>({...s,cvv:e.target.value})),placeholder:"123",required:!0})]})]})]})]})]}),(0,t.jsx)("div",{className:"lg:col-span-1",children:(0,t.jsxs)(x,{className:"sticky top-4",children:[(0,t.jsx)(h,{children:(0,t.jsx)(u,{children:"Booking Summary"})}),(0,t.jsxs)(f,{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[l.outbound&&(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsxs)("span",{children:["Outbound (",i," passenger",i>1?"s":"",")"]}),(0,t.jsxs)("span",{children:["$",l.outbound.price*i]})]}),l.return&&(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsxs)("span",{children:["Return (",i," passenger",i>1?"s":"",")"]}),(0,t.jsxs)("span",{children:["$",l.return.price*i]})]}),(0,t.jsx)(ev,{}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{children:"Subtotal"}),(0,t.jsxs)("span",{children:["$",y*i]})]}),(0,t.jsxs)("div",{className:"flex justify-between text-sm text-muted-foreground",children:[(0,t.jsx)("span",{children:"Taxes & Fees"}),(0,t.jsxs)("span",{children:["$",Math.round(y*i*.15)]})]}),(0,t.jsx)(ev,{}),(0,t.jsxs)("div",{className:"flex justify-between font-bold text-lg",children:[(0,t.jsx)("span",{children:"Total"}),(0,t.jsxs)("span",{children:["$",Math.round(b)]})]})]}),(0,t.jsx)(m,{className:"w-full",onClick:S,disabled:g,children:g?"Processing...":"Complete Booking"}),(0,t.jsx)("div",{className:"text-xs text-muted-foreground text-center",children:(0,t.jsx)("p",{children:"By completing this booking, you agree to our terms and conditions."})})]})]})})]})]})}var ek=a(1671),eS=a(9345),eC=a(8906),eD=a(6337);function eP(e){var s,a;let{selectedFlights:l,passengerDetails:i,totalAmount:n,onPaymentSuccess:d,onBack:c}=e,[o,p]=(0,r.useState)("card"),[j,g]=(0,r.useState)({cardNumber:"",expiryDate:"",cvv:"",cardholderName:""}),[v,y]=(0,r.useState)({address:"",city:"",state:"",zipCode:"",country:""}),[b,w]=(0,r.useState)(!1),[k,S]=(0,r.useState)("idle"),C=async()=>{w(!0),S("sending"),setTimeout(async()=>{try{let e={bookingReference:"SB".concat(Date.now().toString().slice(-6)),flights:l,passengers:i,totalAmount:n,paymentMethod:o,status:"confirmed",bookingDate:new Date().toISOString()},s=await fetch("/api/send-confirmation-email",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:i[0].email,bookingData:e})}),a=await s.json();a.success?(S("sent"),console.log("✅ Email sent successfully:",a)):(S("error"),console.error("❌ Email failed:",a)),setTimeout(()=>{d(e)},1500)}catch(e){console.error("Payment error:",e),S("error"),alert("Payment failed. Please try again."),w(!1)}},3e3)};return(0,t.jsxs)("div",{className:"max-w-4xl mx-auto space-y-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("h2",{className:"text-2xl font-bold",children:"Secure Payment"}),(0,t.jsx)(m,{variant:"outline",onClick:c,disabled:b,children:"Back"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,t.jsxs)("div",{className:"lg:col-span-2 space-y-6",children:[(0,t.jsx)(x,{className:"border-green-200 bg-green-50",children:(0,t.jsx)(f,{className:"p-4",children:(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(eC.Z,{className:"h-5 w-5 text-green-600"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-semibold text-green-800",children:"Secure Payment"}),(0,t.jsx)("p",{className:"text-sm text-green-700",children:"Your payment information is encrypted and secure"})]})]})})}),(0,t.jsx)(x,{className:"border-blue-200 bg-blue-50",children:(0,t.jsx)(f,{className:"p-4",children:(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(eS.Z,{className:"h-5 w-5 text-blue-600"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-semibold text-blue-800",children:"Email Confirmation"}),(0,t.jsxs)("p",{className:"text-sm text-blue-700",children:["Booking confirmation will be sent to: ",(0,t.jsx)("strong",{children:null===(s=i[0])||void 0===s?void 0:s.email})]})]})]})})}),(0,t.jsxs)(x,{children:[(0,t.jsx)(h,{children:(0,t.jsx)(u,{children:"Payment Method"})}),(0,t.jsx)(f,{className:"space-y-4",children:(0,t.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,t.jsx)(m,{variant:"card"===o?"default":"outline",onClick:()=>p("card"),className:"h-16",disabled:b,children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)(eb.Z,{className:"h-6 w-6 mx-auto mb-1"}),(0,t.jsx)("div",{className:"text-xs",children:"Credit Card"})]})}),(0,t.jsx)(m,{variant:"paypal"===o?"default":"outline",onClick:()=>p("paypal"),className:"h-16",disabled:b,children:(0,t.jsx)("div",{className:"text-center",children:(0,t.jsx)("div",{className:"font-bold text-blue-600",children:"PayPal"})})}),(0,t.jsx)(m,{variant:"apple"===o?"default":"outline",onClick:()=>p("apple"),className:"h-16",disabled:b,children:(0,t.jsx)("div",{className:"text-center",children:(0,t.jsx)("div",{className:"font-bold",children:"Apple Pay"})})})]})})]}),"card"===o&&(0,t.jsxs)(x,{children:[(0,t.jsx)(h,{children:(0,t.jsxs)(u,{className:"flex items-center space-x-2",children:[(0,t.jsx)(eb.Z,{className:"h-5 w-5"}),(0,t.jsx)("span",{children:"Card Details"})]})}),(0,t.jsxs)(f,{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(N,{children:"Cardholder Name"}),(0,t.jsx)(J,{value:j.cardholderName,onChange:e=>g(s=>({...s,cardholderName:e.target.value})),placeholder:"John Doe",disabled:b,required:!0})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(N,{children:"Card Number"}),(0,t.jsx)(J,{value:j.cardNumber,onChange:e=>g(s=>({...s,cardNumber:e.target.value})),placeholder:"1234 5678 9012 3456",disabled:b,required:!0})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(N,{children:"Expiry Date"}),(0,t.jsx)(J,{value:j.expiryDate,onChange:e=>g(s=>({...s,expiryDate:e.target.value})),placeholder:"MM/YY",disabled:b,required:!0})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(N,{children:"CVV"}),(0,t.jsx)(J,{value:j.cvv,onChange:e=>g(s=>({...s,cvv:e.target.value})),placeholder:"123",disabled:b,required:!0})]})]})]})]}),(0,t.jsxs)(x,{children:[(0,t.jsx)(h,{children:(0,t.jsx)(u,{children:"Billing Address"})}),(0,t.jsxs)(f,{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(N,{children:"Address"}),(0,t.jsx)(J,{value:v.address,onChange:e=>y(s=>({...s,address:e.target.value})),placeholder:"123 Main Street",disabled:b,required:!0})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(N,{children:"City"}),(0,t.jsx)(J,{value:v.city,onChange:e=>y(s=>({...s,city:e.target.value})),placeholder:"New York",disabled:b,required:!0})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(N,{children:"State"}),(0,t.jsx)(J,{value:v.state,onChange:e=>y(s=>({...s,state:e.target.value})),placeholder:"NY",disabled:b,required:!0})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(N,{children:"ZIP Code"}),(0,t.jsx)(J,{value:v.zipCode,onChange:e=>y(s=>({...s,zipCode:e.target.value})),placeholder:"10001",disabled:b,required:!0})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(N,{children:"Country"}),(0,t.jsxs)(ex,{value:v.country,onValueChange:e=>y(s=>({...s,country:e})),disabled:b,children:[(0,t.jsx)(eu,{children:(0,t.jsx)(eh,{placeholder:"Select country"})}),(0,t.jsxs)(ej,{children:[(0,t.jsx)(eg,{value:"us",children:"United States"}),(0,t.jsx)(eg,{value:"ca",children:"Canada"}),(0,t.jsx)(eg,{value:"uk",children:"United Kingdom"}),(0,t.jsx)(eg,{value:"au",children:"Australia"})]})]})]})]})]})]})]}),(0,t.jsx)("div",{className:"lg:col-span-1",children:(0,t.jsxs)(x,{className:"sticky top-4",children:[(0,t.jsx)(h,{children:(0,t.jsx)(u,{children:"Payment Summary"})}),(0,t.jsxs)(f,{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[l.outbound&&(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{children:"Outbound Flight"}),(0,t.jsxs)("span",{children:["$",l.outbound.price*i.length]})]}),l.return&&(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{children:"Return Flight"}),(0,t.jsxs)("span",{children:["$",l.return.price*i.length]})]}),(0,t.jsxs)("div",{className:"flex justify-between text-sm text-muted-foreground",children:[(0,t.jsx)("span",{children:"Taxes & Fees"}),(0,t.jsxs)("span",{children:["$",Math.round(.13*n)]})]}),(0,t.jsx)(ev,{}),(0,t.jsxs)("div",{className:"flex justify-between font-bold text-lg",children:[(0,t.jsx)("span",{children:"Total Amount"}),(0,t.jsxs)("span",{children:["$",n]})]})]}),(0,t.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,t.jsx)("p",{className:"font-semibold",children:"Passengers:"}),i.map((e,s)=>(0,t.jsxs)("p",{className:"text-muted-foreground",children:[e.firstName," ",e.lastName]},s))]}),"idle"!==k&&(0,t.jsx)("div",{className:"p-3 bg-gray-50 rounded-lg",children:(()=>{switch(k){case"sending":return(0,t.jsxs)("div",{className:"flex items-center space-x-2 text-blue-600",children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600"}),(0,t.jsx)("span",{children:"Sending confirmation email..."})]});case"sent":return(0,t.jsxs)("div",{className:"flex items-center space-x-2 text-green-600",children:[(0,t.jsx)(ek.Z,{className:"h-4 w-4"}),(0,t.jsx)("span",{children:"Confirmation email sent!"})]});case"error":return(0,t.jsxs)("div",{className:"flex items-center space-x-2 text-red-600",children:[(0,t.jsx)(eS.Z,{className:"h-4 w-4"}),(0,t.jsx)("span",{children:"Email failed (booking still confirmed)"})]});default:return null}})()}),(0,t.jsx)(m,{className:"w-full",onClick:C,disabled:b,children:b?(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),(0,t.jsx)("span",{children:"Processing Payment..."})]}):(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(eD.Z,{className:"h-4 w-4"}),(0,t.jsxs)("span",{children:["Pay $",n]})]})}),(0,t.jsxs)("div",{className:"text-xs text-muted-foreground text-center",children:[(0,t.jsx)("p",{children:"Your payment is secured with 256-bit SSL encryption"}),(0,t.jsxs)("p",{className:"mt-1",children:["Confirmation email will be sent to ",null===(a=i[0])||void 0===a?void 0:a.email]})]})]})]})})]})]})}var eZ=a(2735);function eR(e){let{bookingData:s,onNewBooking:a}=e,{bookingReference:r,flights:l,passengers:i,totalAmount:n,bookingDate:d}=s,c=e=>{let{flight:s,passenger:a,type:l}=e;return(0,t.jsxs)(x,{className:"mb-6 overflow-hidden",children:[(0,t.jsx)("div",{className:"bg-gradient-to-r from-blue-600 to-blue-800 text-white p-4",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(k.Z,{className:"h-6 w-6"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"font-bold text-lg",children:s.airline}),(0,t.jsxs)("p",{className:"text-blue-100",children:["Flight ",s.flightNumber]})]})]}),(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsx)(ea,{variant:"secondary",className:"bg-white text-blue-800",children:"outbound"===l?"OUTBOUND":"RETURN"}),(0,t.jsx)("p",{className:"text-sm text-blue-100 mt-1",children:0===s.stops?"Direct Flight":"".concat(s.stops," Stop").concat(s.stops>1?"s":"")})]})]})}),(0,t.jsxs)(f,{className:"p-6",children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6",children:[(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"text-3xl font-bold text-gray-900",children:s.departure.time}),(0,t.jsx)("div",{className:"text-lg font-semibold text-gray-700",children:s.departure.airport}),(0,t.jsxs)("div",{className:"text-sm text-gray-500 flex items-center justify-center mt-1",children:[(0,t.jsx)(y.Z,{className:"h-4 w-4 mr-1"}),s.departure.date]})]}),(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsxs)("div",{className:"flex items-center justify-center mb-2",children:[(0,t.jsx)("div",{className:"h-px bg-gray-300 flex-1"}),(0,t.jsx)(k.Z,{className:"h-5 w-5 text-gray-400 mx-4"}),(0,t.jsx)("div",{className:"h-px bg-gray-300 flex-1"})]}),(0,t.jsxs)("div",{className:"text-sm text-gray-600 flex items-center justify-center",children:[(0,t.jsx)(et.Z,{className:"h-4 w-4 mr-1"}),s.duration]}),(0,t.jsx)("div",{className:"text-xs text-gray-500 mt-1",children:s.aircraft})]}),(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"text-3xl font-bold text-gray-900",children:s.arrival.time}),(0,t.jsx)("div",{className:"text-lg font-semibold text-gray-700",children:s.arrival.airport}),(0,t.jsxs)("div",{className:"text-sm text-gray-500 flex items-center justify-center mt-1",children:[(0,t.jsx)(y.Z,{className:"h-4 w-4 mr-1"}),s.arrival.date]})]})]}),(0,t.jsx)(ev,{className:"my-4"}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("h4",{className:"font-semibold text-gray-700 mb-2 flex items-center",children:[(0,t.jsx)(ey.Z,{className:"h-4 w-4 mr-2"}),"Passenger Details"]}),(0,t.jsxs)("div",{className:"space-y-1",children:[(0,t.jsxs)("p",{className:"font-medium",children:[a.firstName," ",a.lastName]}),(0,t.jsx)("p",{className:"text-sm text-gray-600",children:a.email}),(0,t.jsx)("p",{className:"text-sm text-gray-600",children:a.phone})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"font-semibold text-gray-700 mb-2",children:"Booking Details"}),(0,t.jsxs)("div",{className:"space-y-1",children:[(0,t.jsxs)("p",{className:"text-sm",children:[(0,t.jsx)("span",{className:"font-medium",children:"Booking Ref:"})," ",r]}),(0,t.jsxs)("p",{className:"text-sm",children:[(0,t.jsx)("span",{className:"font-medium",children:"Seat:"})," ",Math.floor(30*Math.random())+1,"A"]}),(0,t.jsxs)("p",{className:"text-sm",children:[(0,t.jsx)("span",{className:"font-medium",children:"Gate:"})," ",String.fromCharCode(65+Math.floor(10*Math.random())),Math.floor(20*Math.random())+1]})]})]})]}),(0,t.jsxs)("div",{className:"mt-6 text-center",children:[(0,t.jsx)("div",{className:"inline-block bg-black text-white px-4 py-2 font-mono text-xs",children:"||||| |||| | |||| ||||| | |||| |||||"}),(0,t.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:r})]})]})]})};return(0,t.jsxs)("div",{className:"max-w-4xl mx-auto space-y-6",children:[(0,t.jsxs)("div",{className:"text-center space-y-4",children:[(0,t.jsx)("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto",children:(0,t.jsx)(k.Z,{className:"h-8 w-8 text-green-600"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Booking Confirmed!"}),(0,t.jsx)("p",{className:"text-gray-600 mt-2",children:"Your flight has been successfully booked. Here are your e-tickets."})]})]}),(0,t.jsx)(x,{className:"bg-green-50 border-green-200",children:(0,t.jsx)(f,{className:"p-6",children:(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-center",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"font-semibold text-green-800",children:"Booking Reference"}),(0,t.jsx)("p",{className:"text-2xl font-bold text-green-900",children:r})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"font-semibold text-green-800",children:"Total Passengers"}),(0,t.jsx)("p",{className:"text-2xl font-bold text-green-900",children:i.length})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"font-semibold text-green-800",children:"Total Amount"}),(0,t.jsxs)("p",{className:"text-2xl font-bold text-green-900",children:["$",n]})]})]})})}),(0,t.jsx)("div",{className:"space-y-6",children:i.map((e,s)=>(0,t.jsxs)("div",{children:[(0,t.jsxs)("h2",{className:"text-xl font-semibold mb-4",children:["Ticket for ",e.firstName," ",e.lastName]}),l.outbound&&(0,t.jsx)(c,{flight:l.outbound,passenger:e,type:"outbound"}),l.return&&(0,t.jsx)(c,{flight:l.return,passenger:e,type:"return"})]},s))}),(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[(0,t.jsxs)(m,{variant:"outline",className:"flex items-center space-x-2",children:[(0,t.jsx)(eZ.Z,{className:"h-4 w-4"}),(0,t.jsx)("span",{children:"Download PDF"})]}),(0,t.jsxs)(m,{variant:"outline",className:"flex items-center space-x-2",children:[(0,t.jsx)(eS.Z,{className:"h-4 w-4"}),(0,t.jsx)("span",{children:"Email Tickets"})]}),(0,t.jsx)(m,{onClick:a,children:"Book Another Flight"})]}),(0,t.jsx)(x,{className:"bg-blue-50 border-blue-200",children:(0,t.jsxs)(f,{className:"p-6",children:[(0,t.jsx)("h3",{className:"font-semibold text-blue-800 mb-3",children:"Important Information"}),(0,t.jsxs)("ul",{className:"text-sm text-blue-700 space-y-2",children:[(0,t.jsx)("li",{children:"• Please arrive at the airport at least 2 hours before domestic flights and 3 hours before international flights"}),(0,t.jsx)("li",{children:"• Bring a valid government-issued photo ID for domestic flights or passport for international flights"}),(0,t.jsx)("li",{children:"• Check-in online 24 hours before your flight to save time at the airport"}),(0,t.jsxs)("li",{children:["• Your confirmation email has been sent to ",i[0].email]})]})]})})]})}function e_(){let[e,s]=(0,r.useState)(null),[a,l]=(0,r.useState)("search"),[i,n]=(0,r.useState)({}),[d,c]=(0,r.useState)({from:null,to:null,departDate:void 0,returnDate:void 0,passengers:1,tripType:"round-trip"}),[o,p]=(0,r.useState)(null),[j,g]=(0,r.useState)(!1),[C,R]=(0,r.useState)(null),[_,F]=(0,r.useState)(!1);(0,r.useEffect)(()=>{let e=localStorage.getItem("user");if(e)try{s(JSON.parse(e))}catch(e){console.error("Failed to parse user from localStorage",e),localStorage.removeItem("user"),localStorage.removeItem("token")}},[]);let T=(s,a)=>{if(console.log("Flight selected:",s,"Type:",a),!e){F(!0);return}n(e=>({...e,[a]:s}));let t={...i,[a]:s};if("one-way"===d.tripType||t.outbound&&t.return){var r,c;let s=Math.round((((null===(r=t.outbound)||void 0===r?void 0:r.price)||0)+((null===(c=t.return)||void 0===c?void 0:c.price)||0))*d.passengers*1.15),a=(null==e?void 0:e.email)||"demo@example.com",i=(null==e?void 0:e.name)||"Demo User",n=Array.from({length:d.passengers},(e,s)=>({id:s+1,firstName:0===s?i.split(" ")[0]||"John":"Passenger".concat(s+1),lastName:0===s?i.split(" ")[1]||"Doe":"LastName".concat(s+1),email:0===s?a:"passenger".concat(s+1,"@example.com"),phone:0===s?"+1234567890":"+123456789".concat(s),dateOfBirth:"1990-01-01",gender:"male"}));R({passengers:n,totalAmount:s,flights:t,userId:e.id}),console.log("Proceeding to payment with:",{passengers:n,totalAmount:s,flights:t}),l("payment")}else console.log("Waiting for more flight selections...")},Y=()=>{l("confirmation")},z=()=>{l("search"),n({}),R(null),p(null)},q=async()=>{if(!d.from||!d.to||!d.departDate){alert("Please fill in all required fields");return}g(!0);try{let e=await fetch("/api/flights/search",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({from:d.from.code,to:d.to.code,departDate:d.departDate,returnDate:d.returnDate,passengers:d.passengers,tripType:d.tripType})});if(e.ok){let s=await e.json();p(s)}else throw Error("Failed to search flights")}catch(e){console.error("Search error:",e),alert("Failed to search flights. Please try again.")}finally{g(!1)}};return(0,t.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100",children:[(0,t.jsx)("header",{className:"bg-white shadow-sm border-b",children:(0,t.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(k.Z,{className:"h-8 w-8 text-blue-600"}),(0,t.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"SkyBooker"})]}),e?(0,t.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,t.jsxs)("span",{className:"text-gray-700",children:["Hello, ",e.name,"!"]}),(0,t.jsxs)(m,{variant:"outline",onClick:()=>{localStorage.removeItem("user"),localStorage.removeItem("token"),s(null),l("search"),n({}),R(null),p(null)},children:[(0,t.jsx)(S.Z,{className:"mr-2 h-4 w-4"}),"Logout"]})]}):(0,t.jsx)(m,{variant:"outline",onClick:()=>F(!0),children:"Login / Sign Up"})]})})}),(0,t.jsx)("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:(()=>{switch(a){case"search":return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(x,{className:"mb-8",children:[(0,t.jsx)(h,{children:(0,t.jsxs)(u,{className:"flex items-center space-x-2",children:[(0,t.jsx)(v.Z,{className:"h-5 w-5"}),(0,t.jsx)("span",{children:"Search Flights"})]})}),(0,t.jsxs)(f,{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"flex space-x-4",children:[(0,t.jsx)(m,{variant:"round-trip"===d.tripType?"default":"outline",onClick:()=>c(e=>({...e,tripType:"round-trip"})),children:"Round Trip"}),(0,t.jsx)(m,{variant:"one-way"===d.tripType?"default":"outline",onClick:()=>c(e=>({...e,tripType:"one-way"})),children:"One Way"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(N,{htmlFor:"from",children:"From"}),(0,t.jsx)(L,{placeholder:"Departure airport",onSelect:e=>c(s=>({...s,from:e})),selectedAirport:d.from})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(N,{htmlFor:"to",children:"To"}),(0,t.jsx)(L,{placeholder:"Destination airport",onSelect:e=>c(s=>({...s,to:e})),selectedAirport:d.to})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(N,{children:"Departure Date"}),(0,t.jsxs)(D,{children:[(0,t.jsx)(P,{asChild:!0,children:(0,t.jsxs)(m,{variant:"outline",className:"w-full justify-start text-left font-normal",children:[(0,t.jsx)(y.Z,{className:"mr-2 h-4 w-4"}),d.departDate?(0,ei.WU)(d.departDate,"PPP"):"Select date"]})}),(0,t.jsx)(Z,{className:"w-auto p-0",children:(0,t.jsx)(ed,{mode:"single",selected:d.departDate,onSelect:e=>c(s=>({...s,departDate:e})),disabled:e=>e<new Date,initialFocus:!0})})]})]}),"round-trip"===d.tripType&&(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(N,{children:"Return Date"}),(0,t.jsxs)(D,{children:[(0,t.jsx)(P,{asChild:!0,children:(0,t.jsxs)(m,{variant:"outline",className:"w-full justify-start text-left font-normal",children:[(0,t.jsx)(y.Z,{className:"mr-2 h-4 w-4"}),d.returnDate?(0,ei.WU)(d.returnDate,"PPP"):"Select date"]})}),(0,t.jsx)(Z,{className:"w-auto p-0",children:(0,t.jsx)(ed,{mode:"single",selected:d.returnDate,onSelect:e=>c(s=>({...s,returnDate:e})),disabled:e=>e<(d.departDate||new Date),initialFocus:!0})})]})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(N,{children:"Passengers"}),(0,t.jsxs)(ex,{value:d.passengers.toString(),onValueChange:e=>c(s=>({...s,passengers:parseInt(e)})),children:[(0,t.jsxs)(eu,{className:"w-full md:w-48",children:[(0,t.jsx)(b.Z,{className:"mr-2 h-4 w-4"}),(0,t.jsx)(eh,{})]}),(0,t.jsx)(ej,{children:[1,2,3,4,5,6,7,8].map(e=>(0,t.jsxs)(eg,{value:e.toString(),children:[e," ",1===e?"Passenger":"Passengers"]},e))})]})]}),(0,t.jsx)(m,{onClick:q,className:"w-full md:w-auto",disabled:j,children:j?"Searching...":"Search Flights"})]})]}),o&&(0,t.jsx)(el,{results:o,onFlightSelect:T})]});case"booking":return(0,t.jsx)(ew,{selectedFlights:i,passengers:d.passengers,onBookingComplete:Y,onBack:z});case"payment":return(0,t.jsx)(eP,{selectedFlights:i,passengerDetails:(null==C?void 0:C.passengers)||[],totalAmount:(null==C?void 0:C.totalAmount)||0,onPaymentSuccess:e=>{R(e),l("ticket")},onBack:()=>l("search")});case"ticket":return(0,t.jsx)(eR,{bookingData:C,onNewBooking:()=>{l("search"),n({}),R(null),p(null)}});case"confirmation":return(0,t.jsx)(x,{className:"w-full max-w-md text-center mx-auto",children:(0,t.jsxs)(f,{className:"p-8",children:[(0,t.jsx)("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,t.jsx)(w.Z,{className:"h-8 w-8 text-green-600"})}),(0,t.jsx)("h2",{className:"text-2xl font-bold mb-2",children:"Booking Confirmed!"}),(0,t.jsx)("p",{className:"text-muted-foreground mb-6",children:"Your flight has been successfully booked. You will receive a confirmation email shortly."}),(0,t.jsx)(m,{onClick:z,className:"w-full",children:"Book Another Flight"})]})});default:return null}})()}),(0,t.jsx)(B,{open:_,onOpenChange:F,children:(0,t.jsx)(O,{className:"p-0",children:(0,t.jsx)(ee,{onLoginSuccess:()=>{let e=localStorage.getItem("user");e&&s(JSON.parse(e)),F(!1)},onClose:()=>F(!1)})})})]})}}},function(e){e.O(0,[428,971,117,744],function(){return e(e.s=9416)}),_N_E=e.O()}]);